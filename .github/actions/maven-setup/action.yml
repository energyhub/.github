name: "Setup Maven"
description: "Setup JDK 17, maven cache, and JFrog credentials"

inputs:
  jfrog-user:
    description: JFrog username used to create the access key (password)
    required: true
  jfrog-password:
    description: JFrog access key (password)
    required: true

runs:
  using: composite
  steps:
    - name: Set up JDK 17
      uses: actions/setup-java@v3
      with:
        java-version: "17"
        distribution: "temurin"
    - name: Cache local Maven repository
      uses: actions/cache@v3
      with:
        path: ~/.m2/repository
        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
        restore-keys: |
          ${{ runner.os }}-maven-
    - shell: bash
      run: echo "${{ github.action_path }}" >> $GITHUB_PATH
#    - name: Checkout .github repository
#      shell: bash
#      run: |
#        https://raw.githubusercontent.com/energyhub/.github/cat_49_remove_unapproved/
    - name: Configure Maven
      shell: bash
      run: |
        pwd
        ls .
        sed "s/{username}/${{ inputs.jfrog-user }}/;s/{access_token}/${{ inputs.jfrog-password }}/"\
          ./.github/actions/maven-setup/home_m2_settings.xml.template > $HOME/.m2/settings.xml
